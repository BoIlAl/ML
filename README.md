# ML
 
### Описание программы 
По поданным на вход фотографии упаковки продукта, а также данным некоторого человека определить, в каком количестве рекомендуется употреблять этот продукт.

### Вход 
  + фотография в формате jpg состава продукта, на которой указано количество белков, жиров, углеводов;
  + описание параметров человека, а также его цели

### Выход 
Число, обозначающее, какое количество продукта в день рекомендуеся употреблять.

### Требования к входным данным   
 #### Фотография  
  + Разрешение фотографии не менее 1280x720 px  
  + На фотографии только один продукт  
 #### Описание человека
  + Пол
  + Возраст - между 10 и 80
  + Вес - целое число от 40 до 160
  + Рост - целое число от 130 до 230
  + Уровень активности - целое число:
    - 1 -- полное отсутствие
    - 2 -- сидячий образ жизни
    - 3 -- небольшая физическая нагрузка 1-3 раза в неделю
    - 4 -- небольшая физическая нагрузка 4-5 раза в неделю
    - 5 -- небольшая физическая нагрузка 7 раз в неделю или большая 3-4 раза
    - 6 -- большая физическая нагрузка 6-7 раз в неделю
    - 7 -- большая физическая нагрузка 7 раз в неделю или тяжелая физическая работа
  + Цель:
    - Поддержка веса
    - Мягкое похудение
    - Похудение
    - Сильное похудение
    - Мягкий набор веса
    - Набор веса
    - Сильный набор веса

### План решения задачи
1. Преобразование исходного изображения  
    - Морфологическая и пороговая фильтрация  
2. Выделение текста из изображения  
    - С использованием pytesseract  
3. Выделение числовых и категориальных характеристик из текста   
    - Поиск чисел, следующих за ключевыми словами-параметрами с использованием регулярных выражений    
4. Предсказание результата на основе обученной модели  
    - Обучение модели с использованием текстовых данных в размере 7000 строк, 2/3  данных - обучающая выборка, 1/3 - тестовая
    - Обучение методом градиентного бустинга с использованием XGBoost

### Оценка результатов
  + Выделение текста из изображения:
    - Плохой результат, если: мелкий или нестандартный шрифт, блики, неконтрастный текст, неровные упаковки.
  + Регрессия:
    - MAE: 13.368346861303834
    - RMSE: 67.1243097950559
